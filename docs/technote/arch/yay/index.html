<!DOCTYPE html>
<html>
  <head>
    <title>Alice in the Machine - wiki</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-12-27T15:07:26 JST">
<title>Yay :: Alice in the Machine - wiki</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/wiki.browniealice.net\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/technote/arch/yay/">
    
      <header>
  <div class="logo">
    
	
  
    <p><a href="https://wiki.browniealice.net/">Alice in the Machine - wiki</a></p>

  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://blog.browniealice.net"  rel="noopener">
                  Blog
                </a>
            </li>
            <li class="" role="">
                <a href="https://wiki.browniealice.net"  rel="noopener">
                  wiki
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/BrownieAlice/"  rel="noopener">
                  GitHub
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/BrownieAlice/wiki.git"  rel="noopener">
                  Repo
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="https://wiki.browniealice.net/technote/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/technote/">TechNote</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="https://wiki.browniealice.net/technote/arch/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/technote/arch/">Arch Linux</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://wiki.browniealice.net/technote/arch/yay/" class="dd-item active">
        <div>
          <a href="/technote/arch/yay/">
            Yay
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://wiki.browniealice.net/technote/hugo/" class="dd-item haschildren
        ">
      <div>
      <a href="/technote/hugo/">Hugo</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://wiki.browniealice.net/technote/hugo/how_to_use_hugo/" class="dd-item">
        <div>
          <a href="/technote/hugo/how_to_use_hugo/">
            Hugo使い方
          </a>
        </div>
    </li>
      <li data-nav-id="https://wiki.browniealice.net/technote/hugo/setting_for_robust/" class="dd-item">
        <div>
          <a href="/technote/hugo/setting_for_robust/">
            Robust設定
          </a>
        </div>
    </li>
      <li data-nav-id="https://wiki.browniealice.net/technote/hugo/setting_for_docdock/" class="dd-item">
        <div>
          <a href="/technote/hugo/setting_for_docdock/">
            DocDock設定
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>




    </ul>
    <section><p style="text-align:center;">
Copyright &copy; 2017-2019, BrownieAlice.<br>
<a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'><img alt='クリエイティブ・コモンズ・ライセンス' style='border-width:0' src='https://i.creativecommons.org/l/by-sa/4.0/80x15.png' /></a>
</p>

    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/technote/" >
   TechNote</option> 
    <option value="/technote/arch/" >
  - 
   Arch Linux</option> 
      <option value="/technote/arch/yay/"  selected>-- Yay</option>
  
    <option value="/technote/hugo/" >
  - 
   Hugo</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/wiki.browniealice.net\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Yay</h1>
    
    
    
    <p><a href="https://github.com/Jguer/yay">Yay</a>はGo言語で書かれたAURヘルパ.<br>
<a href="https://archlinux.fr/yaourt-en">yaourt</a>は現在メンテナンスされていないため, 代わりのAURヘルパとしてYayがよく用いられているように思う.</p>
<h2 id="heading">インストール</h2>
<p>GitHubのリポジトリに記載されている <code>README.md</code> の通り以下を実行すれば良い.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://aur.archlinux.org/yay.git
cd yay
makepkg -si
</code></pre></div><h2 id="heading-1">設定保存</h2>
<p>Yayが内部で呼び出すpacmanやgitなどの実行コマンドを変更することができる.
例えば, gitコマンドを<code>git-dev</code>としてYayを実行する場合は</p>
<pre><code>yay -Syu --git git-dev
</code></pre><p>となる.
この設定は保存することができ, 標準では<code>$HOME/.config/yay/config.json</code>に保存される.<br>
設定を変更して保存するには<code>--save</code>オプションを使う.
上の設定を保存する場合には</p>
<pre><code>yay --save --git git-dev
</code></pre><p>とする.</p>
<h2 id="heading-2">高速化</h2>
<p>Yayを使っているときのボトルネックは, 公式リポジトリのソフトウェアをダウンロードする際に1つずつ順番に行っていくところだろう.<br>
Yay自体はそこに関する並列化は行わないため, pacmanの代わりに<a href="https://xyne.archlinux.ca/projects/powerpill/">powerpill</a>を使うようにする必要がある.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h3 id="heading-3">インストール</h3>
<p>powerpillや他に必要な<a href="https://xyne.archlinux.ca/projects/reflector/">reflector</a>とrsyncをインストールする.
powerpillのみAURパッケージ.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yay -S reflector rsync powerpill
</code></pre></div><h3 id="reflector">reflector設定</h3>
<p>まずreflectorを用いて高速なサーバをいくつか取得する.
日本, 韓国, 香港, 台湾サーバから最新の20個のリストを取得して早い順に6個を表示させている.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo reflector -p rsync -f <span style="color:#ae81ff">6</span> -l <span style="color:#ae81ff">20</span> -c JP -c KR -c HK -c TW
</code></pre></div><p>私の環境では</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Server = rsync://ftp.jaist.ac.jp/pub/Linux/ArchLinux/$repo/os/$arch
Server = rsync://ftp.tsukuba.wide.ad.jp/archlinux/$repo/os/$arch
Server = rsync://jpn.mirror.pkgbuild.com/packages/$repo/os/$arch
Server = rsync://archlinux.cs.nctu.edu.tw/archlinux/$repo/os/$arch
Server = rsync://ftp.tku.edu.tw/archlinux/$repo/os/$arch
Server = rsync://hkg.mirror.rackspace.com/archlinux/$repo/os/$arch
</code></pre></div><p>以上のような結果が得られた.
これらのサーバをパッケージの更新の際に利用するために, <code>/etc/powerpill/powerpill.json</code> 内の <code>rsync</code> の <code>servers</code> の項目を</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">&#34;servers&#34;: [&#34;rsync://ftp.jaist.ac.jp/pub/Linux/ArchLinux/$repo/os/$arch&#34;,
    &#34;rsync://ftp.tsukuba.wide.ad.jp/archlinux/$repo/os/$arch&#34;,
    &#34;rsync://jpn.mirror.pkgbuild.com/packages/$repo/os/$arch&#34;,
    &#34;rsync://archlinux.cs.nctu.edu.tw/archlinux/$repo/os/$arch&#34;,
    &#34;rsync://ftp.tku.edu.tw/archlinux/$repo/os/$arch&#34;,
    &#34;rsync://hkg.mirror.rackspace.com/archlinux/$repo/os/$arch&#34;]
</code></pre></div><p>上のように書き換える.</p>
<h3 id="pacman">pacman設定</h3>
<p>このままではpowerpill実行のたびにエラーメッセージが表示されてしまう.<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>
脚注のサイトの通り, <code>/etc/pacman.conf</code> の　<code>SigLevel</code> の設定を</p>
<pre><code class="language-conf" data-lang="conf">SigLevel = PackageRequired
</code></pre><p>に変更する.</p>
<h3 id="yay">yay設定</h3>
<p>pacmanの代わりにpowerpillを実行する場合は, コマンド引数として <code>--pacman powerpill</code> を与える必要がある.
毎度入力するのは面倒くさいため, yayの設定ファイルに保存させておくといいだろう</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yay --save --pacman powerpill
</code></pre></div><p>上を実行すると, いつも通りのコマンドで並列にダウンロードがなされる.</p>
<h2 id="heading-4">色付きの出力</h2>
<p>リポジトリの<code>README.md</code>に書かれている通り, <code>/etc/pacman.conf</code>内にある</p>
<pre><code class="language-conf" data-lang="conf">#Color
</code></pre><p>のコメントアウトを外し</p>
<pre><code class="language-conf" data-lang="conf">Color
</code></pre><p>とする.</p>
<h2 id="sudo">sudoループ</h2>
<p>AURリポジトリにあるソフトウェアをインストールする場合, sudo権限がタイムアウトして再度パスワードを入力する必要が生じることがある.
これを回避するために, Yayがバックグラウンドでsudoを呼び出し続け回避させるオプション<code>--sudoloop</code>がある.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yay --save --sudoloop
</code></pre></div><p>上を実行して設定を変更しておくと便利だろう.</p>
<h2 id="heading-5">参考文献</h2>
<ul>
<li><a href="https://wiki.archlinux.jp/index.php/Reflector">Reflector - ArchWiki</a></li>
<li><a href="https://wiki.archlinux.jp/index.php/Powerpill">Powerpill - ArchWiki</a></li>
<li><a href="https://wiki.archlinux.jp/index.php/AUR_%E3%83%98%E3%83%AB%E3%83%91%E3%83%BC">AUR ヘルパー - ArchWiki</a></li>
<li><a href="https://github.com/Jguer/yay">Jguer/yay: Yet another Yogurt - An AUR Helper written in Go</a></li>
</ul>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://github.com/Jguer/yay/issues/685">https://github.com/Jguer/yay/issues/685</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="https://wiki.archlinux.jp/index.php/Powerpill#.E3.83.88.E3.83.A9.E3.83.96.E3.83.AB.E3.82.B7.E3.83.A5.E3.83.BC.E3.83.86.E3.82.A3.E3.83.B3.E3.82.B0">https://wiki.archlinux.jp/index.php/Powerpill#.E3.83.88.E3.83.A9.E3.83.96.E3.83.AB.E3.82.B7.E3.83.A5.E3.83.BC.E3.83.86.E3.82.A3.E3.83.B3.E3.82.B0</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/technote/arch/" title="Arch Linux"> <i class="fa fa-chevron-left"></i><label>Arch Linux</label></a>
    <a class="nav nav-next" href="/technote/hugo/" title="Hugo" style="margin-right: 0px;"><label>Hugo</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    
    <div class="tags"> 
      
        <a class="label label-default" href="https://wiki.browniealice.net/tags/arch-linux">Arch Linux</a>
      
    </div>
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i>  27/12/2019
    </div>
    

    
  </div>


	<div>


  
    
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>